{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-agro-header-{{ ai_gen_id }} {
    display: block;
    width: 100%;
    background-color: {{ block.settings.header_bg_color }};
    border-bottom: 1px solid {{ block.settings.border_color }};
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  }

  .ai-agro-header__container-{{ ai_gen_id }} {
    max-width: 1400px;
    margin: 0 auto;
    padding: {{ block.settings.header_padding }}px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 20px;
  }

  .ai-agro-header__logo-{{ ai_gen_id }} {
    flex-shrink: 0;
    display: flex;
    align-items: center;
  }

  .ai-agro-header__logo-link-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    text-decoration: none;
    color: {{ block.settings.text_color }};
  }

  .ai-agro-header__logo-image-{{ ai_gen_id }} {
    max-height: {{ block.settings.logo_height }}px;
    width: auto;
    display: block;
  }

  .ai-agro-header__logo-placeholder-{{ ai_gen_id }} {
    width: {{ block.settings.logo_height }}px;
    height: {{ block.settings.logo_height }}px;
    background-color: {{ block.settings.accent_color }};
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .ai-agro-header__logo-placeholder-{{ ai_gen_id }} svg {
    width: 60%;
    height: 60%;
    fill: white;
  }

  .ai-agro-header__logo-text-{{ ai_gen_id }} {
    margin-left: 12px;
    font-size: {{ block.settings.logo_text_size }}px;
    font-weight: 700;
    color: {{ block.settings.text_color }};
  }

  .ai-agro-header__search-{{ ai_gen_id }} {
    flex: 1;
    max-width: 600px;
    position: relative;
  }

  .ai-agro-header__search-form-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
  }

  .ai-agro-header__search-input-{{ ai_gen_id }} {
    width: 100%;
    padding: 12px 50px 12px 16px;
    border: 1px solid {{ block.settings.search_border_color }};
    border-radius: {{ block.settings.search_border_radius }}px;
    background-color: {{ block.settings.search_bg_color }};
    color: {{ block.settings.text_color }};
    font-size: 14px;
    transition: all 0.3s ease;
  }

  .ai-agro-header__search-input-{{ ai_gen_id }}:focus {
    outline: none;
    border-color: {{ block.settings.accent_color }};
    box-shadow: 0 0 0 3px {{ block.settings.accent_color }}1a;
  }

  .ai-agro-header__search-input-{{ ai_gen_id }}::placeholder {
    color: {{ block.settings.placeholder_color }};
  }

  .ai-agro-header__search-button-{{ ai_gen_id }} {
    position: absolute;
    right: 8px;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    padding: 8px;
    cursor: pointer;
    color: {{ block.settings.accent_color }};
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.3s ease;
  }

  .ai-agro-header__search-button-{{ ai_gen_id }}:hover {
    opacity: 0.7;
  }

  .ai-agro-header__search-icon-{{ ai_gen_id }} {
    width: 20px;
    height: 20px;
  }

  .ai-agro-header__nav-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 24px;
  }

  .ai-agro-header__nav-link-{{ ai_gen_id }} {
    text-decoration: none;
    color: {{ block.settings.text_color }};
    font-size: {{ block.settings.nav_font_size }}px;
    font-weight: 500;
    transition: color 0.3s ease;
    white-space: nowrap;
  }

  .ai-agro-header__nav-link-{{ ai_gen_id }}:hover {
    color: {{ block.settings.accent_color }};
  }

  .ai-agro-header__cart-{{ ai_gen_id }} {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .ai-agro-header__cart-link-{{ ai_gen_id }} {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    color: {{ block.settings.text_color }};
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .ai-agro-header__cart-link-{{ ai_gen_id }}:hover {
    color: {{ block.settings.accent_color }};
  }

  .ai-agro-header__cart-icon-{{ ai_gen_id }} {
    width: 24px;
    height: 24px;
  }

  .ai-agro-header__cart-count-{{ ai_gen_id }} {
    position: absolute;
    top: -8px;
    right: -8px;
    background-color: {{ block.settings.cart_badge_color }};
    color: {{ block.settings.cart_badge_text_color }};
    font-size: 11px;
    font-weight: 700;
    min-width: 18px;
    height: 18px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 4px;
  }

  .ai-agro-header__account-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .ai-agro-header__account-link-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    justify-content: center;
    color: {{ block.settings.text_color }};
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .ai-agro-header__account-link-{{ ai_gen_id }}:hover {
    color: {{ block.settings.accent_color }};
  }

  .ai-agro-header__account-icon-{{ ai_gen_id }} {
    width: 24px;
    height: 24px;
  }

  .ai-agro-header__mobile-toggle-{{ ai_gen_id }} {
    display: none;
    background: none;
    border: none;
    padding: 8px;
    cursor: pointer;
    color: {{ block.settings.text_color }};
  }

  .ai-agro-header__mobile-toggle-icon-{{ ai_gen_id }} {
    width: 24px;
    height: 24px;
  }

  .ai-agro-header__mobile-menu-{{ ai_gen_id }} {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: {{ block.settings.header_bg_color }};
    z-index: 2000;
    overflow-y: auto;
    transform: translateX(-100%);
    transition: transform 0.3s ease;
  }

  .ai-agro-header__mobile-menu-{{ ai_gen_id }}.active {
    transform: translateX(0);
  }

  .ai-agro-header__mobile-menu-header-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px;
    border-bottom: 1px solid {{ block.settings.border_color }};
  }

  .ai-agro-header__mobile-close-{{ ai_gen_id }} {
    background: none;
    border: none;
    padding: 8px;
    cursor: pointer;
    color: {{ block.settings.text_color }};
  }

  .ai-agro-header__mobile-close-icon-{{ ai_gen_id }} {
    width: 24px;
    height: 24px;
  }

  .ai-agro-header__mobile-nav-{{ ai_gen_id }} {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .ai-agro-header__mobile-nav-link-{{ ai_gen_id }} {
    text-decoration: none;
    color: {{ block.settings.text_color }};
    font-size: 18px;
    font-weight: 500;
    padding: 12px 0;
    border-bottom: 1px solid {{ block.settings.border_color }};
  }

  .ai-agro-header__mobile-search-{{ ai_gen_id }} {
    padding: 0 20px 20px;
  }

  @media screen and (max-width: 990px) {
    .ai-agro-header__search-{{ ai_gen_id }} {
      display: none;
    }

    .ai-agro-header__nav-{{ ai_gen_id }} {
      display: none;
    }

    .ai-agro-header__mobile-toggle-{{ ai_gen_id }} {
      display: block;
    }

    .ai-agro-header__mobile-menu-{{ ai_gen_id }} {
      display: block;
    }

    .ai-agro-header__container-{{ ai_gen_id }} {
      gap: 12px;
    }
  }

  @media screen and (max-width: 749px) {
    .ai-agro-header__logo-text-{{ ai_gen_id }} {
      font-size: {{ block.settings.logo_text_size | times: 0.8 }}px;
    }

    .ai-agro-header__logo-image-{{ ai_gen_id }} {
      max-height: {{ block.settings.logo_height | times: 0.8 }}px;
    }

    .ai-agro-header__container-{{ ai_gen_id }} {
      padding: {{ block.settings.header_padding | times: 0.8 }}px 16px;
    }
  }
{% endstyle %}

<agro-header-{{ ai_gen_id }} class="ai-agro-header-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-agro-header__container-{{ ai_gen_id }}">
    <div class="ai-agro-header__logo-{{ ai_gen_id }}">
      <a href="/" class="ai-agro-header__logo-link-{{ ai_gen_id }}">
        {% if block.settings.logo %}
          <img
            src="{{ block.settings.logo | image_url: width: 400 }}"
            alt="{{ shop.name }}"
            class="ai-agro-header__logo-image-{{ ai_gen_id }}"
            width="{{ block.settings.logo.width }}"
            height="{{ block.settings.logo.height }}"
            loading="eager"
          >
        {% else %}
          <div class="ai-agro-header__logo-placeholder-{{ ai_gen_id }}">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5zm0 2.18l8 3.6v8.72c0 4.54-3.08 8.79-7.5 9.93-.34-.09-.68-.18-1-.29V4.18z"/>
              <path d="M12 6L6 9v6c0 3.31 2.29 6.41 5.5 7.18V6z"/>
            </svg>
          </div>
        {% endif %}
        {% if block.settings.show_company_name %}
          <span class="ai-agro-header__logo-text-{{ ai_gen_id }}">{{ block.settings.company_name }}</span>
        {% endif %}
      </a>
    </div>

    <div class="ai-agro-header__search-{{ ai_gen_id }}">
      <form action="/search" method="get" class="ai-agro-header__search-form-{{ ai_gen_id }}" role="search">
        <input
          type="search"
          name="q"
          class="ai-agro-header__search-input-{{ ai_gen_id }}"
          placeholder="{{ block.settings.search_placeholder }}"
          aria-label="Search products"
        >
        <button type="submit" class="ai-agro-header__search-button-{{ ai_gen_id }}" aria-label="Search">
          <svg class="ai-agro-header__search-icon-{{ ai_gen_id }}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
        </button>
      </form>
    </div>

    <nav class="ai-agro-header__nav-{{ ai_gen_id }}">
      {% if block.settings.link_1_url != blank %}
        <a href="{{ block.settings.link_1_url }}" class="ai-agro-header__nav-link-{{ ai_gen_id }}">
          {{ block.settings.link_1_text }}
        </a>
      {% endif %}

      {% if block.settings.link_2_url != blank %}
        <a href="{{ block.settings.link_2_url }}" class="ai-agro-header__nav-link-{{ ai_gen_id }}">
          {{ block.settings.link_2_text }}
        </a>
      {% endif %}

      {% if block.settings.link_3_url != blank %}
        <a href="{{ block.settings.link_3_url }}" class="ai-agro-header__nav-link-{{ ai_gen_id }}">
          {{ block.settings.link_3_text }}
        </a>
      {% endif %}

      <div class="ai-agro-header__cart-{{ ai_gen_id }}">
        <a href="/cart" class="ai-agro-header__cart-link-{{ ai_gen_id }}" aria-label="Shopping cart">
          <svg class="ai-agro-header__cart-icon-{{ ai_gen_id }}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
          {% if cart.item_count > 0 %}
            <span class="ai-agro-header__cart-count-{{ ai_gen_id }}">{{ cart.item_count }}</span>
          {% endif %}
        </a>
      </div>

      <div class="ai-agro-header__account-{{ ai_gen_id }}">
        <a href="/account" class="ai-agro-header__account-link-{{ ai_gen_id }}" aria-label="Account">
          <svg class="ai-agro-header__account-icon-{{ ai_gen_id }}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </a>
      </div>
    </nav>

    <button class="ai-agro-header__mobile-toggle-{{ ai_gen_id }}" aria-label="Open menu" aria-expanded="false">
      <svg class="ai-agro-header__mobile-toggle-icon-{{ ai_gen_id }}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
  </div>

  <div class="ai-agro-header__mobile-menu-{{ ai_gen_id }}">
    <div class="ai-agro-header__mobile-menu-header-{{ ai_gen_id }}">
      <div class="ai-agro-header__logo-{{ ai_gen_id }}">
        <a href="/" class="ai-agro-header__logo-link-{{ ai_gen_id }}">
          {% if block.settings.logo %}
            <img
              src="{{ block.settings.logo | image_url: width: 200 }}"
              alt="{{ shop.name }}"
              class="ai-agro-header__logo-image-{{ ai_gen_id }}"
              width="{{ block.settings.logo.width }}"
              height="{{ block.settings.logo.height }}"
              loading="eager"
            >
          {% else %}
            <div class="ai-agro-header__logo-placeholder-{{ ai_gen_id }}">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5zm0 2.18l8 3.6v8.72c0 4.54-3.08 8.79-7.5 9.93-.34-.09-.68-.18-1-.29V4.18z"/>
                <path d="M12 6L6 9v6c0 3.31 2.29 6.41 5.5 7.18V6z"/>
              </svg>
            </div>
          {% endif %}
          {% if block.settings.show_company_name %}
            <span class="ai-agro-header__logo-text-{{ ai_gen_id }}">{{ block.settings.company_name }}</span>
          {% endif %}
        </a>
      </div>
      <button class="ai-agro-header__mobile-close-{{ ai_gen_id }}" aria-label="Close menu">
        <svg class="ai-agro-header__mobile-close-icon-{{ ai_gen_id }}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="ai-agro-header__mobile-search-{{ ai_gen_id }}">
      <form action="/search" method="get" class="ai-agro-header__search-form-{{ ai_gen_id }}" role="search">
        <input
          type="search"
          name="q"
          class="ai-agro-header__search-input-{{ ai_gen_id }}"
          placeholder="{{ block.settings.search_placeholder }}"
          aria-label="Search products"
        >
        <button type="submit" class="ai-agro-header__search-button-{{ ai_gen_id }}" aria-label="Search">
          <svg class="ai-agro-header__search-icon-{{ ai_gen_id }}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
        </button>
      </form>
    </div>

    <nav class="ai-agro-header__mobile-nav-{{ ai_gen_id }}">
      {% if block.settings.link_1_url != blank %}
        <a href="{{ block.settings.link_1_url }}" class="ai-agro-header__mobile-nav-link-{{ ai_gen_id }}">
          {{ block.settings.link_1_text }}
        </a>
      {% endif %}

      {% if block.settings.link_2_url != blank %}
        <a href="{{ block.settings.link_2_url }}" class="ai-agro-header__mobile-nav-link-{{ ai_gen_id }}">
          {{ block.settings.link_2_text }}
        </a>
      {% endif %}

      {% if block.settings.link_3_url != blank %}
        <a href="{{ block.settings.link_3_url }}" class="ai-agro-header__mobile-nav-link-{{ ai_gen_id }}">
          {{ block.settings.link_3_text }}
        </a>
      {% endif %}

      <a href="/cart" class="ai-agro-header__mobile-nav-link-{{ ai_gen_id }}">
        Cart ({{ cart.item_count }})
      </a>

      <a href="/account" class="ai-agro-header__mobile-nav-link-{{ ai_gen_id }}">
        Account
      </a>
    </nav>
  </div>
</agro-header-{{ ai_gen_id }}>

<script>
  (function() {
    class AgroHeader{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.mobileToggle = this.querySelector('.ai-agro-header__mobile-toggle-{{ ai_gen_id }}');
        this.mobileMenu = this.querySelector('.ai-agro-header__mobile-menu-{{ ai_gen_id }}');
        this.mobileClose = this.querySelector('.ai-agro-header__mobile-close-{{ ai_gen_id }}');

        if (this.mobileToggle && this.mobileMenu && this.mobileClose) {
          this.mobileToggle.addEventListener('click', () => this.openMobileMenu());
          this.mobileClose.addEventListener('click', () => this.closeMobileMenu());

          this.mobileMenu.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => this.closeMobileMenu());
          });
        }
      }

      openMobileMenu() {
        this.mobileMenu.classList.add('active');
        this.mobileToggle.setAttribute('aria-expanded', 'true');
        document.body.style.overflow = 'hidden';
      }

      closeMobileMenu() {
        this.mobileMenu.classList.remove('active');
        this.mobileToggle.setAttribute('aria-expanded', 'false');
        document.body.style.overflow = '';
      }
    }

    customElements.define('agro-header-{{ ai_gen_id }}', AgroHeader{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Agro header navigation",
  "settings": [
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_height",
      "label": "Logo height",
      "min": 30,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 50
    },
    {
      "type": "checkbox",
      "id": "show_company_name",
      "label": "Show company name",
      "default": true
    },
    {
      "type": "text",
      "id": "company_name",
      "label": "Company name",
      "default": "Bhumi Bhumi Agro Industries"
    },
    {
      "type": "range",
      "id": "logo_text_size",
      "label": "Company name size",
      "min": 12,
      "max": 32,
      "step": 2,
      "unit": "px",
      "default": 18
    },
    {
      "type": "header",
      "content": "Search bar"
    },
    {
      "type": "text",
      "id": "search_placeholder",
      "label": "Placeholder text",
      "default": "Search Product or By Technical Name"
    },
    {
      "type": "range",
      "id": "search_border_radius",
      "label": "Border radius",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "default": 8
    },
    {
      "type": "header",
      "content": "Navigation links"
    },
    {
      "type": "text",
      "id": "link_1_text",
      "label": "Link 1 text",
      "default": "Agri Advisor"
    },
    {
      "type": "url",
      "id": "link_1_url",
      "label": "Link 1 URL"
    },
    {
      "type": "text",
      "id": "link_2_text",
      "label": "Link 2 text",
      "default": "Contact"
    },
    {
      "type": "url",
      "id": "link_2_url",
      "label": "Link 2 URL"
    },
    {
      "type": "text",
      "id": "link_3_text",
      "label": "Link 3 text",
      "default": "Blogs"
    },
    {
      "type": "url",
      "id": "link_3_url",
      "label": "Link 3 URL"
    },
    {
      "type": "range",
      "id": "nav_font_size",
      "label": "Navigation font size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 15
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "header_padding",
      "label": "Vertical padding",
      "min": 8,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 16
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "header_bg_color",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent color",
      "default": "#2d8659"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border",
      "default": "#e5e5e5"
    },
    {
      "type": "color",
      "id": "search_bg_color",
      "label": "Search background",
      "default": "#f5f5f5"
    },
    {
      "type": "color",
      "id": "search_border_color",
      "label": "Search border",
      "default": "#dddddd"
    },
    {
      "type": "color",
      "id": "placeholder_color",
      "label": "Placeholder text",
      "default": "#999999"
    },
    {
      "type": "color",
      "id": "cart_badge_color",
      "label": "Cart badge background",
      "default": "#ff5722"
    },
    {
      "type": "color",
      "id": "cart_badge_text_color",
      "label": "Cart badge text",
      "default": "#ffffff"
    }
  ],
  "presets": [
    {
      "name": "Agro header navigation"
    }
  ]
}
{% endschema %}
